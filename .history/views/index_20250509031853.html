<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ELRIEL | Digital Wasteland Terminal</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="ELRIEL - A forgotten underground internet cathedral. Part TempleOS, part Geocities, part industrial hacker shrine. Enter the digital wasteland.">
  <meta name="keywords" content="ELRIEL, terminal, haunted web, digital wasteland, cyberpunk, retro, glitch, hackers, webcore, neocities">
  <meta name="author" content="ELRIEL Network">

  <!-- Open Graph / Social Media -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://elriel.network/">
  <meta property="og:title" content="ELRIEL | Digital Wasteland Terminal">
  <meta property="og:description" content="Enter the forgotten underground internet cathedral. A cyberpunk dreamworld awaits.">
  <meta property="og:image" content="/images/elriel-og-image.png">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ELRIEL | Digital Wasteland Terminal">
  <meta name="twitter:description" content="Enter the forgotten underground internet cathedral. A cyberpunk dreamworld awaits.">
  <meta name="twitter:image" content="/images/elriel-twitter-image.png">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=VT323&family=Share+Tech+Mono&family=IBM+Plex+Mono&display=swap" rel="stylesheet">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="/css/cyberpunk-terminal.css">

  <!-- Core scripts -->
  <script src="/js/error-logger.js" defer></script>
  <script src="/js/cyberpunk-terminal.js" defer></script>
  <script src="/js/terminal.js?v=1" defer></script>

  <!-- Enhancement scripts -->
  <script src="/js/accessibility.js" defer></script>
  <script src="/js/navigation-debug.js" defer></script>
  <script src="/js/mobile-enhancements.js" defer></script>
  <script src="/js/performance-fixes.js" defer></script>
  <link rel="stylesheet" href="/css/responsive-fixes.css">
</head>
<body class="terminal">
  <!-- Screen Effects -->
  <div class="noise-overlay"></div>
  <div class="scan-lines"></div>
  <div class="crt-effect"></div>

  <!-- Main Container -->
  <div class="container">
    <header class="main-header">
      <div class="logo">
        <h1 class="glitch" data-text="ELRIEL">ELRIEL</h1>
        <div class="logo-subtitle">DIGITAL WASTELAND v1.3.7</div>
      </div>
      <div class="user-panel">
        <div id="user-status">
          <!-- User status will be injected here -->
        </div>
      </div>
    </header>

    <div class="content-wrapper">
      <nav class="sidebar">
        <div class="nav-section">
          <h3 class="nav-title">MAIN SYSTEMS</h3>
          <ul class="nav-links">
            <li><a href="/" class="active">TERMINAL</a></li>
            <li><a href="/feed/bleedstream" id="bleedstream-link">BLEEDSTREAM</a></li>
            <li><a href="/glyph/crucible" id="crucible-link">GLYPH CRUCIBLE</a></li>
            <li><a href="/whisper/board" id="whisper-link">WHISPERBOARD</a></li>
            <li><a href="/forum/scrapyard" id="scrapyard-link">SCRAPYARD</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <h3 class="nav-title">DISTRICTS</h3>
          <ul class="nav-links">
            <li><a href="/terminal/numbpill" class="district">NUMBPILL CELL</a></li>
            <li><a href="#" class="district locked">LOCKED DISTRICT</a></li>
            <li><a href="#" class="district locked">LOCKED DISTRICT</a></li>
          </ul>
        </div>
        <div class="nav-section">
          <h3 class="nav-title">SYSTEM</h3>
          <ul class="nav-links">
            <li><a href="/about">ABOUT</a></li>
            <li><a href="#" id="toggle-glitch">TOGGLE GLITCH</a></li>
          </ul>
        </div>
      </nav>

      <main class="main-content">
        <!-- System Log Sidebar -->
        <aside class="system-log-sidebar">
          <div class="panel-header">
            <h2>SYSTEM LOG</h2>
            <div class="status-indicator">LIVE</div>
          </div>
          <div class="panel-content" id="system-log">
            <div class="log-entry">
              <span class="log-time">05:38:08</span>
              <span class="log-text">User [REDACTED] joined the Numbpill Cell</span>
            </div>
            <div class="log-entry">
              <span class="log-time">05:11:31</span>
              <span class="log-text">New whisper detected in sector 7</span>
            </div>
            <div class="log-entry">
              <span class="log-time">05:45:44</span>
              <span class="log-text">Glyph Crucible activity increased by 27%</span>
            </div>
            <div class="log-entry">
              <span class="log-time">05:18:17</span>
              <span class="log-text">System scan complete: 3 anomalies detected</span>
            </div>
            <div class="log-entry">
              <span class="log-time">05:11:43</span>
              <span class="log-text">User terminal_ghost uploaded a new post</span>
            </div>
            <div class="log-entry">
              <span class="log-time">05:18:09</span>
              <span class="log-text">District access protocols updated</span>
            </div>
          </div>
        </aside>

        <!-- Main Terminal Window -->
        <section class="panel welcome-panel">
          <div class="scanner-line"></div>
          <div class="panel-header">
            <h2>TERMINAL ACCESS</h2>
            <div class="status-indicator alert">COMPROMISED</div>
          </div>
          <div class="panel-content">
            <div class="terminal-output">
              <div class="line">INITIALIZING ELRIEL NETWORK CONNECTION...</div>
              <div class="line">ESTABLISHING SECURE CHANNEL...</div>
              <div class="line">TERMINAL ACCESS GRANTED.</div>
              <div class="line">&nbsp;</div>
              <div class="line blink">WELCOME TO ELRIEL. THIS TERMINAL HAS BEEN COMPROMISED.</div>
              <div class="line">&nbsp;</div>
              <div class="line">THE NETWORK AWAITS YOUR CONTRIBUTION.</div>
              <div class="line">PROCEED WITH CAUTION.</div>
              <div class="line">&nbsp;</div>
              <div class="line">TYPE 'HELP' FOR AVAILABLE COMMANDS.</div>
              <div class="line">&nbsp;</div>
              <div class="command-line">
                <label for="terminal-input" class="sr-only">Terminal command input</label>
                <input type="text" id="terminal-input" autocomplete="off" autofocus aria-label="Terminal command input">
              </div>
            </div>
          </div>
        </section>

        <!-- System Alert Window -->
        <section class="panel announcement-panel">
          <div class="scanner-line"></div>
          <div class="panel-header">
            <h2>SYSTEM ALERT</h2>
            <div class="status-indicator">PRIORITY</div>
          </div>
          <div class="panel-content">
            <div class="announcement-content" id="announcement">
              <!-- Announcement will be injected here -->
              <h3 class="announcement-title flicker">CONNECTION INSTABILITY DETECTED</h3>
              <div class="announcement-body">Welcome to Elriel. This terminal has been compromised. Proceed with caution. The Numbpill Cell awaits your contribution.</div>
              <div class="announcement-timestamp">TIMESTAMP: 4/21/2025, 6:38:34 AM</div>
            </div>
          </div>
        </section>

        <!-- ASCII Art Glyphs -->
        <section class="panel ascii-panel">
          <div class="panel-header">
            <h2>TERMINAL GLYPHS</h2>
            <div class="status-indicator">ARCHIVE</div>
          </div>
          <div class="panel-content ascii-content">
            <div class="ascii-grid">
              <div class="ascii-cell" id="glyph1">
                <!-- Will be populated by JS -->
              </div>
              <div class="ascii-cell" id="glyph2">
                <!-- Will be populated by JS -->
              </div>
              <div class="ascii-cell" id="glyph3">
                <!-- Will be populated by JS -->
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <footer class="main-footer">
      <div class="footer-text">ELRIEL NETWORK // ESTABLISHED 2025 // ALL RIGHTS SURRENDERED</div>
      <div class="footer-glyphs">
        <span class="glyph">⌘</span>
        <span class="glyph">⍟</span>
        <span class="glyph">⎔</span>
      </div>
    </footer>
  </div>

  <!-- ASCII art generator script -->
  <script>
    // Initialize glyphs after DOM load
    document.addEventListener('DOMContentLoaded', function() {
      console.log("Initializing Elriel Terminal Interface...");

      // Generate random ASCII art for the glyphs
      generateRandomGlyphs();

      // System log updating simulation
      initSystemLog();

      // Inject server data if available
      processServerData();

      // Terminal command setup is handled by terminal.js but extended here
      enhanceTerminalCommands();

      // Add easter eggs and hidden features
      initHiddenFeatures();

      // Initialize toggle glitch functionality
      initToggleGlitch();
    });

    // Generate random ASCII art glyphs
    function generateRandomGlyphs() {
      const glyphContainers = [
        document.getElementById('glyph1'),
        document.getElementById('glyph2'),
        document.getElementById('glyph3')
      ];

      // Glyph shapes and characters
      const glyphChars = ['/', '\\', '|', '-', '+', '*', ':', '.', '=', '#', '@', '&', '%', '□', '■', '▲', '△', '○', '●'];
      const glyphTemplates = [
        // Circle-based glyph
        function(chars) {
          return `
   ${chars[0]}${chars[1]}${chars[1]}${chars[0]}
 ${chars[2]}      ${chars[2]}
${chars[3]}        ${chars[3]}
${chars[3]}   ${chars[4]}${chars[4]}   ${chars[3]}
${chars[3]}   ${chars[4]}${chars[4]}   ${chars[3]}
${chars[3]}        ${chars[3]}
 ${chars[2]}      ${chars[2]}
   ${chars[0]}${chars[1]}${chars[1]}${chars[0]}
          `;
        },
        // Square-based glyph
        function(chars) {
          return `
 ${chars[0]}${chars[1]}${chars[1]}${chars[1]}${chars[0]}
 ${chars[2]}     ${chars[2]}
 ${chars[2]} ${chars[3]}${chars[3]} ${chars[2]}
 ${chars[2]} ${chars[3]}${chars[3]} ${chars[2]}
 ${chars[2]}     ${chars[2]}
 ${chars[0]}${chars[1]}${chars[1]}${chars[1]}${chars[0]}
          `;
        },
        // Triangle-based glyph
        function(chars) {
          return `
    ${chars[0]}
   ${chars[1]}${chars[1]}
  ${chars[2]}${chars[3]}${chars[2]}
 ${chars[4]}${chars[5]}${chars[5]}${chars[4]}
${chars[6]}${chars[7]}${chars[7]}${chars[7]}${chars[6]}
          `;
        }
      ];

      // Generate and apply random glyphs
      glyphContainers.forEach(container => {
        if (!container) return;

        // Select random template and characters
        const template = glyphTemplates[Math.floor(Math.random() * glyphTemplates.length)];
        const selectedChars = Array(8).fill().map(() =>
          glyphChars[Math.floor(Math.random() * glyphChars.length)]
        );

        // Create a pre element with the glyph
        const glyphElement = document.createElement('pre');
        glyphElement.className = 'ascii-art';
        glyphElement.textContent = template(selectedChars);

        // Add some animations
        const animations = ['pulse-glow', 'blink-glow', 'flicker-glow'];
        glyphElement.classList.add(animations[Math.floor(Math.random() * animations.length)]);

        // Add to container
        container.innerHTML = '';
        container.appendChild(glyphElement);

        // Make glyph interactive
        container.addEventListener('click', function() {
          // Generate new glyph on click
          const newChars = Array(8).fill().map(() =>
            glyphChars[Math.floor(Math.random() * glyphChars.length)]
          );
          glyphElement.textContent = template(newChars);

          // Play glitch sound
          if (window.elrielTerminal && window.elrielTerminal.playGlitchSound) {
            window.elrielTerminal.playGlitchSound();
          }
        });
      });
    }

    // Simulate updating system log
    function initSystemLog() {
      const systemLog = document.getElementById('system-log');
      if (!systemLog) return;

      // Possible system log messages
      const possibleLogs = [
        'Connection attempt from unknown IP',
        'Packet loss detected in subnet',
        'Memory corruption in sector %d',
        'User %s logged in from %s',
        'Firewall rule %d triggered',
        'Data stream corrupted: %s',
        'New glyph pattern discovered',
        'Signal strength at %d percent',
        'Background radiation increasing',
        'Authentication failure: %s',
        'Terminal %d disconnected',
        'Encryption key rotation successful',
        'Whisper channel noise increased',
        'Anomaly detected in scrapyard',
        'System temperature: %d°C'
      ];

      // Random string generators for placeholders
      const randomString = () => {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        let result = '';
        for (let i = 0; i < 8; i++) {
          result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
      };

      // Replace placeholders with random values
      const formatLogMessage = (message) => {
        return message
          .replace('%d', Math.floor(Math.random() * 100))
          .replace('%s', randomString());
      };

      // Add new log periodically
      setInterval(() => {
        if (Math.random() < 0.3) { // 30% chance to add a new log
          const currentTime = new Date();
          const timeString = currentTime.toLocaleTimeString('en-US', {
            hour12: false,
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
          });

          const logMessage = possibleLogs[Math.floor(Math.random() * possibleLogs.length)];
          const formattedMessage = formatLogMessage(logMessage);

          const logEntry = document.createElement('div');
          logEntry.className = 'log-entry';
          logEntry.innerHTML = `
            <span class="log-time">${timeString}</span>
            <span class="log-text">${formattedMessage}</span>
          `;

          // Add to top of log
          systemLog.insertBefore(logEntry, systemLog.firstChild);

          // Remove old logs if too many
          if (systemLog.children.length > 20) {
            systemLog.removeChild(systemLog.lastChild);
          }

          // Occasionally add glitch effect to a random log
          if (Math.random() < 0.1) {
            const logs = systemLog.querySelectorAll('.log-entry');
            const randomLog = logs[Math.floor(Math.random() * logs.length)];
            randomLog.classList.add('glitch-text');
            setTimeout(() => {
              randomLog.classList.remove('glitch-text');
            }, 2000);
          }
        }
      }, 5000); // Check every 5 seconds
    }

    // Process data injected from the server
    function processServerData() {
      try {
        // Inject data from server
        const data = __DATA__;

        // Update user status
        const userStatusEl = document.getElementById('user-status');
        if (data && data.user) {
          userStatusEl.innerHTML = `
            <div class="logged-in">
              <span class="username">${data.user.username}</span>
              <div class="user-links">
                <a href="/profile" class="button">PROFILE</a>
                <a href="/auth/logout" class="button">LOGOUT</a>
              </div>
            </div>
          `;
        } else {
          userStatusEl.innerHTML = `
            <div class="logged-out">
              <a href="/auth/login" class="button login-btn">LOGIN</a>
              <a href="/auth/register" class="button register-btn">REGISTER</a>
            </div>
          `;
        }

        // Update announcement if exists
        const announcementEl = document.getElementById('announcement');
        if (data && data.announcement) {
          announcementEl.innerHTML = `
            <h3 class="announcement-title flicker">${data.announcement.title}</h3>
            <div class="announcement-body">${data.announcement.content}</div>
            <div class="announcement-timestamp">TIMESTAMP: ${new Date(data.announcement.created_at).toLocaleString()}</div>
          `;
        }

        console.log("Server data processed successfully");
      } catch (err) {
        console.error("Error processing server data:", err);
      }
    }

    // Enhance terminal commands and interactivity
    function enhanceTerminalCommands() {
      // This extends the basic terminal.js functionality
      // Add custom commands and behaviors if terminal.js is loaded

      // Fix terminal focus
      const terminalInput = document.getElementById('terminal-input');
      if (terminalInput) {
        // Focus terminal on click anywhere in terminal area
        const terminalOutput = document.querySelector('.terminal-output');
        if (terminalOutput) {
          terminalOutput.addEventListener('click', function() {
            terminalInput.focus();
          });
        }

        // Fix mobile keyboard focus
        document.addEventListener('touchend', function(e) {
          if (e.target.closest('.terminal-output') || e.target.closest('.command-line')) {
            terminalInput.focus();
          }
        });
      }
    }

    // Hidden features and easter eggs
    function initHiddenFeatures() {
      // Add secret keys or click patterns
      let secretCodeProgress = 0;
      const secretCode = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65]; // Konami code

      document.addEventListener('keydown', function(e) {
        // Check for secret code (Konami code)
        if (e.keyCode === secretCode[secretCodeProgress]) {
          secretCodeProgress++;
          if (secretCodeProgress === secretCode.length) {
            secretCodeProgress = 0;
            activateSecretFeature();
          }
        } else {
          secretCodeProgress = 0;
        }
      });

      // Additional hidden interactive elements
      document.querySelectorAll('.glyph').forEach((glyph, index) => {
        glyph.addEventListener('click', function() {
          // Make glyphs interactive
          this.classList.add('pulse-glow');
          setTimeout(() => {
            this.classList.remove('pulse-glow');
          }, 1000);

          // If all glyphs are clicked in sequence, trigger special effect
          if (this.dataset.clicked) return;
          this.dataset.clicked = 'true';

          const allClicked = document.querySelectorAll('.glyph[data-clicked="true"]').length === 3;
          if (allClicked) {
            setTimeout(() => {
              document.querySelectorAll('.glyph').forEach(g => delete g.dataset.clicked);
              activateSecretFeature();
            }, 500);
          }
        });
      });
    }

    // Initialize toggle glitch functionality
    function initToggleGlitch() {
      const toggleGlitchBtn = document.getElementById('toggle-glitch');
      if (toggleGlitchBtn) {
        toggleGlitchBtn.addEventListener('click', function(e) {
          e.preventDefault();
          document.body.classList.toggle('glitch-active');

          // Store preference in localStorage
          localStorage.setItem('glitch-active', document.body.classList.contains('glitch-active') ? 'true' : 'false');

          // Use the terminal glitch sound if available
          if (window.elrielTerminal && window.elrielTerminal.playGlitchSound) {
            window.elrielTerminal.playGlitchSound();
          }
        });
      }

      // Check if glitch effects were previously enabled
      const glitchActive = localStorage.getItem('glitch-active');
      if (glitchActive === 'true') {
        document.body.classList.add('glitch-active');
      }
    }

    // Secret feature activation
    function activateSecretFeature() {
      console.log("Secret feature activated");

      // Create secret message overlay
      const overlay = document.createElement('div');
      overlay.className = 'fullscreen-overlay';
      overlay.innerHTML = `
        <div class="overlay-content">
          <h2>HIDDEN ACCESS GRANTED</h2>
          <pre class="ascii-art">
   ▄████████  ▄█          ▄████████  ▄█     ▄████████  ▄█
  ███    ███ ███         ███    ███ ███    ███    ███ ███
  ███    █▀  ███         ███    ███ ███▌   ███    █▀  ███
 ▄███▄▄▄     ███         ███    ███ ███▌  ▄███▄▄▄     ███
▀▀███▀▀▀     ███       ▀███████████ ███▌ ▀▀███▀▀▀     ███
  ███        ███         ███    ███ ███    ███        ███
  ███        ███▌    ▄   ███    ███ ███    ███        ███▌    ▄
  ███        █████▄▄██   ███    █▀  █▀     ███        █████▄▄██
            ▀                                         ▀
          </pre>
          <p>You've discovered a hidden feature of ELRIEL.</p>
          <p>The system acknowledges your curiosity.</p>
          <button class="button">CLOSE PORTAL</button>
        </div>
      `;

      document.body.appendChild(overlay);

      // Handle closing
      overlay.querySelector('button').addEventListener('click', function() {
        overlay.style.opacity = '0';
        setTimeout(() => {
          overlay.remove();
        }, 500);
      });

      // Auto-close after some time
      setTimeout(() => {
        if (document.body.contains(overlay)) {
          overlay.style.opacity = '0';
          setTimeout(() => overlay.remove(), 500);
        }
      }, 10000);
    }
  </script>
</body>
</html>